# 결합(복합) 인덱스

데이터베이스의 용량이 점점 커지면서 단일 인덱스만으로 해결하기 어려운 상황이 되었다. 결합 인덱스는 이러한 대용량 데이터베이스에서 성능을 향상시킨다.
> 무조건 결합 인덱스가 좋다는 말은 아니다 대부분의 경우에는 결합 인덱스가 성능상 좋다는 말

---
## 1. 처리 범위에 따라 SQL 성능은 달라진다

SQL 성능은 다음

* 처리 범위의 양
* 랜덤 엑세스의 양
* 정렬의 양

3 가지 항목에 좌우된다.


```SQL
SELECT 이름, 이메일
FROM 사용자
WHERE 등록일자 = '20220804'
AND 이름 = '포비'
```

예로 든, SQL문에서 만들 수 있는 인덱스 종류를 살펴보자.

1. 등록일자 인덱스

처리 범위는 등록일자 컬럼에 의해서만 감소하게 되고, 이름에 의해서는 처리 범위가 감소하지 않는다.
따라서, 등록일자 컬럼 값이 `20220804`인 데이터를 모두 엑세스 한 후, 이름이 `포비`인 데이터만 결과로 나타나게 된다.

2. 이름 인덱스

등록일자 인덱스처럼 이름 인덱스 컬럼에 의해서만 처리 범위가 감소하게 된다.

3. 등록일자 인덱스 + 이름 인덱스

처리 범위는 등록일자 컬럼 값이 `20220804`인 데이터를 엑세스 한 후, 감소된 처리 범위에서 이름 컬럼 값이 `포비`인 데이터를 엑세한다. 앞의 등록일자 인덱스나 이름 인덱스 처럼 단일 인덱스보다 처리 범위가 더 감소하므로 SQL 성능 향상을 기대할 수 있다.

4. 이름 인덱스 + 등록일자 인덱스

3번째 인덱스와 같은 원리로 작동한다.

✔︎ 단일 인덱스보다는 결합 인덱스가 SQL 성능에 유리하다는 것을 느꼈을 것이다. 나아가서 또 하나 유의해서 봐야할게 있다. 바로 조건절이다.

```text
SELECT 이름, 이메일
FROM 사용자
WHERE 등록일자 = '20220804'  # where절의 연산자
AND 이름 = '포비'
```

where 절의 조건에는 2 종류가 있다.

1. 점 조건

`in`이나 `=` 연산자를 이용한 조건을 의미하며 해당 연산자는 하나의 점만을 의미

2. 선분 조건

`like`, `between`, `<`, `>` 등과 같이 점 조건을 제외한 연산자를 의미, 하나의 점이 아닌 길게 이저지는 범위를 나타냄

두 조건을 가지고 위 복합 인덱스의 조합을 나타내보면,

1. 점 조건 + 점 조건
2. 점 조건 + 선분 조건
3. 선분 조건 + 선분 조건
4. 선분 조건 + 점 조건